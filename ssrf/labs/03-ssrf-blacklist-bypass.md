# Lab: SSRF with blacklist-based input filter

## 1. ุงููุฏู ูู ุงููุงุจ (Lab Objective)

- **ุงููุฏู ุงูุฑุฆูุณู:** ุชุฌุงูุฒ ููุงุชุฑ ุงูุญูุงูุฉ (Blacklists) ุงูุชู ุชููุน ุงููุตูู ููู Localhost.
- **ุงููุฏู ุงูููุงุฆู:** ุงููุตูู ูู `/admin` ูุญุฐู `carlos`.

## 2. ุดุฑุญ ุงูุซุบุฑุฉ (Vulnerability Explanation)

- **ููุน ุงูุซุบุฑุฉ:** SSRF (Filter Bypass)
- **ุงููุตู:** ุงูุณูุฑูุฑ ูุญุงูู ุญูุงูุฉ ููุณู ุนุจุฑ ูุงุฆูุฉ ุณูุฏุงุก ุชููุน ูููุงุช ูุซู `127.0.0.1` ู `admin`. ููุน ุฐููุ ุงูููุงุชุฑ ุงููุจููุฉ ุนูู ุงูููุงุฆู ุงูุณูุฏุงุก (Blacklists) ุฏุงุฆูุงู ูุง ุชููู ูุงูุตุฉ ููููู ุชุฌุงูุฒูุง ุจุชูููู ุงูุฑุงุจุท ุฃู ุงุณุชุฎุฏุงู ุชูุซูู ูุฎุชูู ููุฃุฑูุงู.

## 3. ุฎุทูุงุช ุงูุญู (Solution Steps)

1. **ุชุฌุงูุฒ ุงูู IP:** ุจุฏูุงู ูู `127.0.0.1`ู ุงุณุชุฎุฏู ุงูุงุฎุชุตุงุฑ ุงูุจุฑูุฌู `127.1` ุฃู ุงูุชูุซูู ุงูุนุดุฑู (Decimal).
2. **ุชุฌุงูุฒ ุงููููุฉ (`admin`):** ุงุณุชุฎุฏู ุงูู **Double URL Encoding** ูุญุฑู ูุงุญุฏ ูู ุงููููุฉ ูุฎุฏุงุน ุงูููุชุฑ:
   - ุญุฑู `a` -> `%61` -> `%2561`.
3. **ุงูุจูุงุก ุงูููุงุฆู:**
   ```url
   stockApi=http://127.1/%2561dmin/delete?username=carlos
   ```

## 4. ุชุญููู ูุนูู (Deep Dive) ๐ก

"ุงููุงุฆูุฉ ุงูุจูุถุงุก" (Allowlist) ุฏุงุฆูุงู ุฃุถูู ูู "ุงููุงุฆูุฉ ุงูุณูุฏุงุก" (Blacklist) ูู ุงูุญูุงูุฉ. ุงูููุงุชุฑ ุงูุถุนููุฉ ูุฏ ุชูู ุชุดููุฑ ุงูุฑุงุจุท ูุฑุฉ ูุงุญุฏุฉ ููุทุ ูุฐุง ุงูุชุดููุฑ ุงููุฒุฏูุฌ ููุฌุญ ูู ุชุฌุงูุฒูุง ูุงููุตูู ูููุฏู.

## 5. ุงูุฃุฏูุงุช ุงููุณุชุฎุฏูุฉ (Tools Used)

- [x] Burp Suite (Repeater)
- [x] Double URL Encoder

---

## ๐ก๏ธ ููู ุชุญูู ููุณูุ (Mitigation)

- **Input Normalization:** ูู ุจุชูุญูุฏ ุดูู ุงูุฑุงุจุท ููู ูู ุทุจูุงุช ุงูุชุดููุฑ ูุจู ููุงุฑูุชู ุจุงูููุชุฑ.
- **IP Allowlisting:** ูุง ุชุณูุญ ุฅูุง ุจุงูุทูุจุงุช ุงูููุฌูุฉ ููุทุงูุงุช ุนุงูุฉ ูููุซููุฉ.

---

[ุฑุงุจุท ุงููุฎุชุจุฑ ุงูุฃุตูู](https://portswigger.net/web-security/ssrf/lab-ssrf-with-blacklist-filter)
