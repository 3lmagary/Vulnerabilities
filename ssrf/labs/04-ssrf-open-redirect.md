## 1. ุงููุฏู ูู ุงููุงุจุฉ (Lab Objective)

- **ุงููุฏู ุงูุฑุฆูุณู:** ุชุฌุงูุฒ ููุงุชุฑ ุงูู SSRF ุงูุชู ุชููุนู ูู ุงููุตูู ุงููุจุงุดุฑ ููุดุจูุฉ ุงูุฏุงุฎููุฉ ุนุจุฑ ุงุณุชุบูุงู ุซุบุฑุฉ **Open Redirection**.
- **ุงููุฏู ุงูููุงุฆู:** ุงููุตูู ูู `/admin` ุนูู ุงูุณูุฑูุฑ `192.168.0.12:8080` ูุญุฐู ุงููุณุชุฎุฏู `carlos`.

## 2. ุดุฑุญ ุงูุซุบุฑุฉ (Vulnerability Explanation)

- **ููุน ุงูุซุบุฑุฉ:** SSRF via Open Redirect
- **ุงููุตู:** ุงูุณูุฑูุฑ ูููุน ุทูุจ ุฃู ุฑูุงุจุท ุฎุงุฑุฌูุฉ ุฃู ุนูุงููู IP ุฏุงุฎููุฉ ูุจุงุดุฑุฉ ูู ุจุงุฑุงูุชุฑ `stockApi`. ููุน ุฐููุ ูู ูุซู ุจุงูุฑูุงุจุท ุงููุญููุฉ (Local URLs). ุจูุง ุฃููุง ูุฌุฏูุง ุซุบุฑุฉ Open Redirect ุฏุงุฎู ุงูุชุทุจูู ููุณูุ ูููููุง ุงุณุชุบูุงููุง ูู "ุฌุณุฑ" ูุชูุฌูู ุทูุจ ุงูุณูุฑูุฑ ุงูุฏุงุฎูู ุฅูู ุงููุฌูุฉ ุงููุญุธูุฑุฉ.

## 3. ุฎุทูุงุช ุงูุญู (Solution Steps)

1. **ุงูุชุดุงู ุงูู Open Redirect:** ูุงุญุธูุง ุฃู ุฒุฑ "Next Product" ูุฑุณู ุทูุจุงู ูู `/product/nextProduct?currentProductId=X&path=...`. ุจุชุฌุฑุจุฉ ุชุบููุฑ ูููุฉ `path` ูู URL ุฎุงุฑุฌูุ ูุฌุฏูุง ุฃู ุงููููุน ูููู ุจุงูุชุญููู ุจูุฌุงุญ.
2. **ุงูุชุดุงู ุญูุงูุฉ ุงูู SSRF:** ุนูุฏ ูุญุงููุฉ ูุถุน ุงูุฑุงุจุท `http://192.168.0.12:8080/admin` ูุจุงุดุฑุฉ ูู `stockApi`ู ูุธูุฑ ุฎุทุฃ "Invalid external stock check url".
3. **ุชุฌุงูุฒ ุงูุญูุงูุฉ (Exploitation):** ุณูุทูุจ ูู ุงูุณูุฑูุฑ ุฃู ูุทูุจ ุฑุงุจุท ุงูู Redirection ุงูุฏุงุฎููุ ูุงูุฐู ุจุฏูุฑู ุณููุฌูู ููุฑุงุจุท ุงููุทููุจ:

   ```url
   stockApi=/product/nextProduct?path=http://192.168.0.12:8080/admin/delete?username=carlos
   ```

   > [!TIP]
   > ูุฏ ุชุญุชุงุฌ ูุนูู **URL Encoding** ููุฑุงุจุท ุจุฏุงุฎู `path` ูุถูุงู ูุนุงูุฌุชู ุจุดูู ุตุญูุญ ูู ูุจู ุงูุณูุฑูุฑ.

4. **ุทุฑููุฉ ุจุฏููุฉ (Bypass):** ูุฌุญุช ุฃูุถุงู ูุญุงููุฉ ุงุณุชุฎุฏุงู ุงูุตูุบุฉ `@IP` ูุชุฌุงูุฒ ุงูููุชุฑ:

   ```url
   stockApi=@192.168.0.12:8080/admin/delete?username=carlos
   ```

## 4. ุงูุฃุฏูุงุช ุงููุณุชุฎุฏูุฉ (Tools Used)

- [x] Burp Suite (Repeater)
- [x] Browser Developer Tools

---

## ๐ก๏ธ ููู ุชุญูู ููุณูุ (Mitigation)

- **Eliminate Open Redirects:** ูุง ุชุณูุญ ุจุงูุชุญููู ูุฑูุงุจุท ุฎุงุฑุฌูุฉ ุจูุงุกู ุนูู ูุฏุฎูุงุช ุงููุณุชุฎุฏู.
- **Strict SSRF Allowlisting:** ูุง ุชุนุชูุฏ ุนูู ุญุธุฑ ุฑูุงุจุท ูุนููุฉ (Blacklisting) ุจู ุงุณูุญ ููุท ุจุฑูุงุจุท ูุญุฏุฏุฉ ุฌุฏุงู (Allowlisting).
