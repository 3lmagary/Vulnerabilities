# 1 — الفكرة الأساسية

**Information disclosure** = كشف غير مقصود لمعلومات قد تساعد مهاجمًا.  
المعلومات قد تكون حسّاسة (بيانات مستخدمين، مفاتيح) أو فنية (إصدارات برمجيات، مسارات ملفات).  
المهمة: لا تكتفي بالعثور على ثغرة واحدة. ابحث عن أي أثر مفيد أثناء الفحص.

# 2 — منهجية عامة لاختبار كشف المعلومات

1. لا تُحصِر اختبارك في ميزة واحدة.
    
2. افعل فحصًا تشكيليًا ثم استهدف المدخلات المثيرة.
    
3. اجمع كل الملاحظات الصغيرة. فروق السلوك مهمة.
    
4. داوم على تدوين الأدلة (لقطات، رؤوس HTTP، مقتطفات من الشيفرة).
    

# 3 — تقنيات عملية وأدوات (كيف تفحص فعليًا)

## 3.1 الفَزّ (Fuzzing)

- أرسل قيم غير متوقعة لباراميترات (نص بدل رقم، أحرف خاصة، سلاسل طويلة).
    
- راقب حالات الاستجابة: رمز الحالة، طول الاستجابة، الزمن، محتوى الخطأ.
    
- أتمتة: **Burp Intruder** أو أدوات سطر: `ffuf`, `wfuzz`.
    
- استخرج كلمات مفتاحية تلقائيًا: `SELECT`, `error`, `Exception`, `password`.
    

**أمثلة أوامر**

- ffuf بسيط:
    

```
ffuf -u 'https://example.com/product?productId=FUZZ' -w wordlist.txt
```

## 3.2 استخدام Burp Suite

- استخدم **Proxy** لالتقاط الطلبات.
    
- استخدم **Intruder** للفزّ على باراميترات.
    
- استخدم **Comparer** أو اختلافات الاستجابة لتحديد سلوك مختلف.
    
- استخدم **Logger++** من BApp لتصفية وتلوين السجلات.
    
- **Burp Scanner (Pro)** يفحص تلقائياً ويكشف تسريبات مثل مفاتيح، باك أب، قوائم دلائل.
    

## 3.3 Engagement tools داخل Burp

كليك يمين على أي رسالة → Engagement tools:

- **Search**: بحث نصي/Regex داخل الرسائل.
    
- **Find comments**: استخراج تعليقات المطورين داخل HTML.
    
- **Discover content**: محاولة كشف محتوى غير مرتبط مباشرة بالروابط العامة (ملفات/دلائل مخفية).
    

## 3.4 منع التسريبات عبر استجابة هندسية (Engineering informative responses)

- جرّب إدخالات تتسبب باستثناءات. قد تكشف الاستثناءات قيم أو أسماء متغيرات.
    
- استعمل requests مصممة ليقوم السيرفر بعرض القيمة المطلوبة في رسالة خطأ.
    
- راقب فروق الرسائل لاكتشاف حالات مثل enumaration أو valid/invalid.
    

# 4 — مصادر شائعة لتسريب المعلومات وفحص كل منها

1. **ملفات موجهات الزواحف**: `/robots.txt`, `/sitemap.xml`.
    
    - فتحها يدلك أحيانًا على مجلدات مخفية مثل `/backup`.
        
2. **قوائم الدلائل (Directory listings)**
    
    - إذا مفعل: يتيح الوصول لملفات `.bak`, `.sql`, `.zip`.
        
3. **تعليقات المطورين في HTML**
    
    - قد تحتوي على روابط أو ملاحظات عن endpoints.
        
4. **رسائل الخطأ المفصلة (Verbose errors)**
    
    - تكشف stack traces، أسماء جداول وقيم متغيرات.
        
5. **صفحات التصحيح (Debug pages)** مثل `phpinfo()`
    
    - تكشف متغيرات بيئة `$_ENV`، مفاتيح، إعدادات.
        
6. **ملفات النسخ الاحتياطي**
    
    - امتدادات: `.bak`, `~`, `.old`, `.swp`, `.sql`، أو `.zip`.
        
7. **سجل التهيئة الخاطئة للخوادم**
    
    - رؤوس HTTP مثل `Server`, `X-Powered-By`, `ServerTokens`.
        
8. **تاريخ نظام التحكم بالإصدارات**
    
    - وجود `.git` مكشوف يسمح باسترجاع الكود والتاريخ.
        

# 5 — كيف تستغل هذه المعلومات بأمان أثناء التدريب

- فقط في بيئات مختبرية أو بإذن صريح.
    
- مثال عملي آمن: تغيير `productId=1` إلى `productId=test` لملاحظة NumberFormatException.
    
- بعد كشف أي سر افترض أنه مسرّب. تدوير/إبلاغ سريعًا إن في بيئة فعلية.
    

# 6 — خطوات عملية متسلسلة عند فحص موقع جديد

1. طلبات أولية: `GET /`, `GET /robots.txt`, `GET /sitemap.xml`.
    
2. مسح المسارات: `gobuster/ffuf` على `/` مع wordlist.
    
3. فحص رؤوس: `curl -I https://target/` أو استخدم Burp.
    
4. تفحّص صفحات حساسة يدويا: `/cgi-bin/phpinfo.php`, `/backup`, `/.git/`.
    
5. استهداف باراميترات مثيرة بالفَزّ (Intruder/ffuf).
    
6. استخدام Engagement tools للبحث عن تعليقات وكشف محتويات.
    
7. جمع الأدلة وتنظيمها.
    

# 7 — تدابير وقائية وإصلاحية (Per-vulnerability)

## 7.1 رسائل الخطأ والتصحيح

- تعطيل عرض الأخطاء في الإنتاج (`display_errors=Off`, `debug=false`).
    
- إظهار رسالة عامة للمستخدم مع Reference ID.
    
- تخزين الstack traces في سجلات داخلية مؤمّنة.
    

## 7.2 صفحات التصحيح وphpinfo

- احجبها عن الإنتاج. ضعها خلف شبكات داخلية أو مصادقة.
    
- لا تعرض متغيرات بيئة أو مفاتيح في واجهة يمكن الوصول إليها.
    

## 7.3 ملفات النسخ الاحتياطي وقوائم الدلائل

- أزل الملفات الاحتياطية من جذر الويب. خزّنها خارج الـ web root.
    
- أغلق index listing (`Options -Indexes` لأباتشي، `autoindex off` لnginx).
    
- أضف فحوص CI تمنع رفع امتدادات `.bak`, `.sql`, `.env` إلى النشر.
    

## 7.4 تعليقات المطورين

- ازل التعليقات الحساسة قبل النشر. استخدم أدوات البناء التي تزيل التعليقات أو تقلص HTML.
    

## 7.5 إدارة الأسرار

- لا تحزم الأسرار في الشيفرة. استخدم: متغيرات بيئة، Vault، AWS Secrets Manager.
    
- دوّر المفاتيح فور تسريبها.
    

## 7.6 رؤوس الخادم

- أخفِ إصدار الخادم: Apache: `ServerTokens Prod`, `ServerSignature Off`.
    
- nginx: `server_tokens off;`
    

# 8 — نمط تقرير ثغرة جاهز (Template)

1. **العنوان**: Information disclosure — [المصدر، مثال: verbose error message]
    
2. **الملخّص**: سطر واحد يشرح ما الذي سرب ولماذا مهم.
    
3. **التأثير**: شرح عملي مختصر (مثال: كشف إصدار إطار يؤدي لاحقًا لاستغلال X).
    
4. **الخطوات لإعادة الإنشاء**: خطوات قابلة للتنفيذ مع طلبات/URLs.
    
5. **الدليل**: مقتطفات آمنة من الردود، لقطات شاشة، رؤوس HTTP.
    
6. **شدة المشكلة**: Low/Medium/High مع مبرر.
    
7. **التوصيات**: خطوات فورية ومتوسطة وطويلة.
    
8. **ملاحظات المتابعة**: هل تدوير/تحقق بعد التصحيح.
    

# 9 — قائمة فحص جاهزة (Checklist) — انسخها واستخدمها

-  الوصول إلى `/robots.txt` و`/sitemap.xml`.
    
-  تحقق من وجود قائمة دلائل على الخادم.
    
-  بحث عن صفحات debug مثل `phpinfo`, `/debug`.
    
-  اختبار رسائل خطأ عبر إدخال قيم غير متوقعة.
    
-  البحث عن ملفات احتياطية `.bak`, `.old`, `.sql`.
    
-  فحص رؤوس HTTP عن إصدارات مكشوفة.
    
-  تفتيش ملفات الشيفرة المرئية أو `.git` إن كانت موجودة.
    
-  التحقق من عدم وجود مفاتيح أو بيانات اعتماد في الكود.
    
-  إبلاغ وتدوير أي أسرار مكشوفة.
    

# 10 — ملخص اللّابات التي ذكرتها (ملاحظاتك العملية)

1. **Information disclosure in error messages**
    
    - ما وجدته: تغيير `productId=1` إلى `productId=test` كشف stack trace والذي تضمن `Apache Struts 2 2.3.31`.
        
    - النتيجة: استخراج إصدار الإطار.
        
    - توصية: تعطيل عرض الاستثناءات وتحديث Struts.
        
2. **Information disclosure on debug page**
    
    - ما وجدته: رابط/تعليق لصفحة `phpinfo.php`. فتحها كشف `$_SERVER['SECRET_KEY'] = 28ca2kkbrn02d6ezjsupqdw6locqng1o`.
        
    - النتيجة: استخراج SECRET_KEY.
        
    - توصية: إزالة صفحة phpinfo، تدوير المفتاح، قصر الوصول.
        
3. **Source code disclosure via backup files**
    
    - ما وجدته: robots.txt كشف `/backup`. فتح `ProductTemplate.java.bak` كشف كلمة مرور قاعدة بيانات `3esxqoe234wfix3pf5x2snshjbxglb6q`.
        
    - النتيجة: استخراج كلمة مرور DB.
        
    - توصية: إزالة النسخ الاحتياطية، تدوير كلمات المرور، نقل الأسرار إلى نظام مناسب.
        
