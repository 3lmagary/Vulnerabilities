# ๐ก๏ธ [DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded](https://portswigger.net/web-security/cross-site-scripting/dom-based/lab-angularjs-expression)

## ๐ Lab Information
* **Lab Name:** DOM XSS in AngularJS expression with angle brackets and double quotes HTML-encoded
* **Difficulty:** Practitioner
* **Vulnerability Type:** DOM-based XSS (AngularJS Injection)

---

## ๐ 1. Discovery & Reconnaissance

### ุงูููุงุญุธุฉ ุงูุฃููู:
ุงููููุน ูุณุชุฎุฏู ููุชุจุฉ **AngularJS**. ูุฐู ุงูููุชุจุฉ ุชููู ุจูุญุต ูุญุชูู ููุฏ ุงูู HTML ุจุญุซุงู ุนู ุฃู ุนูุตุฑ ูุญุชูู ุนูู `ng-app` attribute.

- **ููุฌูุฏ ูุซู :(`ng-app`, `ng-controller`, `ng-model`, ุฃู  `angular.min.js`).** 
### ุฎุทูุฉ ุงูุชุฃููุฏ (Testing the Injection):
ููุชุญูู ูู ุฃู ุงูู AngularJS ูููู ุจุนูู "Evaluate" ููููุฏุ ูููุง ุจุชุฌุฑุจุฉ ุนูููุฉ ุญุณุงุจูุฉ ุจุณูุทุฉ ุฏุงุฎู ุงูู Double Curly Braces `{{}}`.

* **Input:**
    ```text
    {{7*7}}
    ```
* **Result:**
    ุธูุฑ ูู ุงูุตูุญุฉ ุงูุฑูู `49`.
* **Conclusion:**
    ุงููููุน ูููู ุจุชูููุฐ (Execute) ุชุนุจูุฑุงุช ุงูู AngularJS. ุจูุง ุฃู ุงูุฃููุงุณ `< >` ูุนูุงูุงุช ุงูุชูุตูุต `"` ูุชู ุนูู HTML Encoding ููุงุ ูุง ูููููุง ุงุณุชุฎุฏุงู XSS ุชูููุฏูุ ูุฐุง ุณููุฌุฃ ูู **AngularJS Sandbox Escape**.

---

## ๐ฅ 2. The Exploit

ุงููุฏู ูู ุชูููุฐ ุฏุงูุฉ `alert(1)`. ุจูุง ุฃููุง ุฏุงุฎู ุจูุฆุฉ AngularJSุ ูุญุชุงุฌ ูููุตูู ุฅูู ุงูู `constructor` ุงูุฎุงุต ุจุงูุฏุงูุฉ ูุฅูุดุงุก ูุชูููุฐ ููุฏ JavaScript ุนุดูุงุฆู.

### ุงููุญุงููุฉ:
ุงูููุฏ ูุนุชูุฏ ุนูู ุงุณุชุฏุนุงุก ุงูู constructor ุงูุฎุงุต ุจู `$on` (ุฃู ุฃู object ูุชุงุญ ูู ุงูู scope) ูุฅูุดุงุก ุฏุงูุฉ ุฌุฏูุฏุฉ.

**Payload:**
```javascript
{{$on.constructor('alert(1)')()}}
```
### ุดุฑุญ ุงูุจุงูููุฏ:

1.  **`{{ }}`**: ุชุฎุจุฑ AngularJS ุจุฃู ูุง ุจุฏุงุฎููุง ูู ุชุนุจูุฑ ุจุฑูุฌู ูุฌุจ ุชูููุฐู.
2.  **`$on`**: ูู ุฏุงูุฉ ููุฌูุฏุฉ ุฏุงุฎู ุงูู Scope ุงูุฎุงุต ุจู AngularJS (ุชุณุชุฎุฏู ุนุงุฏุฉ ููู Event Listening).
3.  **`.constructor`**: ุชุนูุฏ ููุง ุงูู "Function Constructor" (ุงูุฐู ููุดุฆ ุงูุฏูุงู).
4.  **`('alert(1)')`**: ููุฑุฑ ููุง ุงูููุฏ ุงูุฐู ูุฑูุฏ ุชูููุฐู ููุต.
5.  **`()`**: ุงูููุณูู ูู ุงูููุงูุฉ ูููููู ุจุชูููุฐ ุงูุฏุงูุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ููุฑุงู.

```js
{{constructor.constructor('alert(1)')()}}
```

