
## [Information disclosure in error messages](https://portswigger.net/web-security/information-disclosure/exploiting/lab-infoleak-in-error-messages)

## الهدف: الحصول على رقم إصدار الإطار من رسالة خطأ مفصّلة في التطبيق.
---

###   خطوات إعادة الإنشاء (Reproduction steps)

1. افتح صفحة المنتجات: `https://<lab-domain>/product?productId=1`.
    
2. عدّل قيمة `productId` من `1` إلى قيمة ليست رقمية لتوليد خطأ في تحليل الرقم. مثال:
    
    - `/product?productId=test`
        
3. أرسِل الطلب ولاحظ استجابة الخادم.
    

**النتيجة المتوقعة**: رسالة خطأ مفصّلة تظهر استثناء Java مع stack trace.

---

###  الدليل 

```
Internal Server Error: java.lang.NumberFormatException: For input string: "test"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:661)
	at java.base/java.lang.Integer.parseInt(Integer.java:777)
	at lab.c.w.x.y.Z(Unknown Source)
...

Apache Struts 2 2.3.31
```

>  السطر الأخير الذي يكشف إصدار الإطار: **Apache Struts 2 2.3.31**.

---

### 5. التحليل والتأثير

- **نوع الثغرة**: Information disclosure عبر رسائل خطأ مفصّلة.
    
- **السبب**: التطبيق يعرض رسائل استثناء مفصّلة في بيئة الإنتاج بدلاً من رسائل عامة. هذا الأثر أتاح كشف معلومات تقنية عن البنية وتحديد إصدار إطار العمل.
    
- **التأثير**: معرفة إصدار إطار عمل قديم يمكن أن تُسهّل على مهاجم استهداف ثغرات معروفة إذا كان الإصدار معرضًا لها. لذلك التأثير يختلف حسب معرفة وجود ثغرات معروفة لذلك الإصدار.
    
---

###  خاتمة

تم حل اللاب باستخراج رقم الإصدار بنجاح: **Apache Struts 2 2.3.31**. التوصيات أعلاه تقلل من خطر تسريب معلومات مماثلة في بيئات الإنتاج.

