![[photo/information-disclosure.jpg]]
# 1 — التعريف 

**تعريف**: Information Disclosure => كشف بيانات غير مقصودة من التطبيق أو البنية التحتية التي قد تُفيد مهاجم.  
**الهدف**: كل ما يكشف عن شيء يمكن أن يُستخدم لاحقًا لهجوم آخر. قد يكون التأثير مباشرًا (بطاقات ائتمان مسرّبة) أو غير مباشر (إصدار مكتبة قديم يُسهل استغلال ثغرة معروفة).

# 2 — أنواع المعلومات المسرَّبة (أمثلة)

1. بيانات مستخدمين حساسة: أسماء، إيميلات، بطاقات ائتمان، سجلات طبية.
    
2. ملفات النسخ الاحتياطي أو الشيفرة المصدرية (.bak, .old, .sql).
    
3. خرائط الدليل، قوائم مجلدات (directory listing) أو robots.txt يكشف مسارات داخلية.
    
4. رسائل خطأ مفصّلة (stack traces, SQL errors) تكشف أسماء جداول، أعمدة، استعلامات.
    
5. مفاتيح API، بيانات اعتماد، عناوين IP داخل الشيفرة.
    
6. رؤوس HTTP المكشوفة (Server, X-Powered-By) وإصدارات البرمجيات.
    
7. إعدادات التصحيح/التشخيص مفعّلة في بيئة الإنتاج (debug mode, verbose logs).
    
8. فروقات سلوكية تُستخدم للتعداد (enumeration) مثل تجاوب مختلف لاسم مستخدم صحيح/خاطئ.
    

# 3 — كيف تنشأ هذه الثغرات (الأسباب الشائعة)

- ترك تعليقات المطورين أو ملفات مؤقتة في بيئة الإنتاج.
    
- ترك وضع التصحيح مفعّل أو عرض استثناءات مفصّلة.
    
- إعدادات خادم افتراضية تكشف معلومات (ServerTokens, ServerSignature).
    
- أخطاء في التصميم من ناحية التفريق في الرسائل/الحالات.
    
- إفشاء مفاتيح/بيانات اعتماد داخل الشيفرة أو ملفات التكوين.
    
- عدم تنظيف أو تقليل بيانات السجلات (logs) قبل عرضها أو مشاركتها.
    

# 4 — كيف تكتشِفها (منهجية واختبارات)

مبدأ عام: اسأل الخادم بطرق متوقعة وغير متوقعة، وسجّل أي معلومات إضافية في الاستجابة أو السجلات.

أ. فحص استهلالي

- راجع `robots.txt` و`/.git/` وملفات النسخ الاحتياطي مثل `backup.zip`, `db.sql`، و`README`، `config.php~`.
    
- افحص رؤوس الاستجابة: `curl -I https://example.com` ثم لاحظ `Server`, `X-Powered-By`, `X-Frame-Options` إلخ.
    
- جرّب فتح مجلد بدون index لمعرفة إن كان هناك directory listing.
    

ب. رسائل الخطأ

- أدخل مدخلات تُسبّب خطأ منطقي أو SQL صالح وشاهد رسالة الخطأ.
    
- افحص اختلافات الشيفرة في الاستجابة (timing، رسائل مختلفة) لمعرفة حالة وجود مستخدم/مورد.
    

ج. البحث عن ملفات ومجلدات مخفية

- أدوات: `dirb`, `gobuster`, `ffuf`, `dirsearch`.
    
- قوائم كلمة/مسارات شاملة للعثور على ملفات مثل `/dev/`, `/staging/`, `/backup/`.
    

د. فحص الشيفرة المصدرية المتاحة

- إذا عثرت على `*.git` أو ملفات `.env` أو نسخ من الشيفرة، ابحث عن مفاتيح وبيانات اعتماد.
    

هـ. البحث داخل الموارد العامة

- تحقق من CDN، خرائط المواقع sitemap.xml، ملفات JavaScript التي قد تحتوي على مفاتيح أو end-points.
    

# 5 — أمثلة واقعية مختصرة

- ملف `error_log` أو stack trace يعرض اسم قاعدة بيانات `customers_prod` واسم جدول `credit_cards` → تأثير عالي.
    
- header `X-Powered-By: PHP/5.6.40` → يُظهر إصدار قديم به ثغرة معروفة → يعطي مسار استغلال محتمل.
    
- robots.txt يحتوي `/admin-old/` → كشف مسار إداري مخفي.
    

# 6 — تقييم الخطورة 

- ما نوع المعلومات المكشوفة؟ (حساسة/فنية/قابلة للاستغلال).
    
- هل يمكن استغلالها مباشرة؟ (نعم → أعلى شدّة).
    
- هل توفر نقطة انطلاق لهجوم آخر؟ (مثلاً إصدار قديم مع ثغرة معلومة).
    
- وجود بيانات اعتماد أو مفاتيح = خطورة عالية.
    
- تسريبات فنية فقط تحتاج إلى ربط مع ثغرة أخرى → اعتبرها ضمن السياق.
    

# 7 — طرق الاستغلال 

- استخدام معلومات إصدار البرمجيات للبحث عن استغلال عام موثّق قد ينطبق.
    
- استخدام أسماء جداول/حقول من رسالة خطأ لتخصيص هجمات SQL injection.
    
- استخدام مفاتيح API أو كلمات مرور من ملف تكوين للحصول على وصول غير مصرح.
    
- استغلال قوائم الدلائل للوصول إلى ملفات النسخ الاحتياطي التي تحوي بيانات حساسة.
    

# 8 — كيف تمنعها 

أ. سياسة عامة وإدارة سرية المعلومات

- علّم الفريق ما هو «حسّاس».
    
- لا تضع مفاتيح أو بيانات اعتماد في الشيفرة. استخدم مخزن أسرار (Vault, AWS Secrets Manager).
    

ب. تكوين الخوادم والـ HTTP

- Apache:
    
    ```
    ServerSignature Off
    ServerTokens Prod
    ```
    
- nginx: `server_tokens off;`
    
- أزل أو عدّل `X-Powered-By` وملصقات الإصدار.
    

ج. بيئة الإنتاج vs التطوير

- تأكد أن `debug=false` و `display_errors=Off` في الإنتاج.
    
- سجّل الأخطاء لكن احفظ السجلات مؤمّنة وقراءتها داخليًا فقط.
    

د. رسائل خطأ عامة

- قدّم رسائل خطأ عامة للمستخدم (مثال: "حدث خطأ داخلي"). سجّل التفاصيل داخليًا.
    

هـ. التحكم بالوصول والوصول إلى الملفات

- امنع الوصول العام إلى ملفات التكوين وملفات النسخ الاحتياطي.
    
- استخدم قواعد للخادم تمنع عرض امتدادات معينة (*.env, *.sql, *.bak).
    
- ضع قواعد في `.htaccess` أو إعداد nginx لمنع عرض مجلدات خاصة.
    

و. إزالة البيانات الحساسة من الشيفرة والتكوين

- اجعل القيم السرّية تُحمّل من متغيرات بيئة أو نظام أسرار.
    
- لا تضع مفاتيح داخل JS الذي يُحمّل على العميل.
    

ز. تحديد مدد حفظ السجلات وتقليصها

- سجّل التفاصيل الضرورية فقط. طمّع في تقليص الحقول الحساسة في السجلات.
    

ح. التحديق والاختبار

- فحّص بانتظام باستخدام فحوص تلقائية (SAST/DAST).
    
- راجع بنيوية الموقع وملفات النشر. اجعل CI يزيل التعليقات/ملفات مؤقتة.
    

# 9 — إعدادات ونماذج تعليمية 

- PHP ini:
    
    ```
    display_errors = Off
    log_errors = On
    error_log = /var/log/php_errors.log
    ```
    
- Flask:
    
    ```py
    app = Flask(__name__)
    app.config['DEBUG'] = False
    app.config['ENV'] = 'production'
    ```
    
- Node/Express: لا تستخدم `app.use(errorhandler())` مع تفصيل الاستثناءات في الإنتاج.
    

# 10 — قائمة فحص (Checklist) سريع للفاحص أو المطوّر

- هل `debug` معطّل في جميع البيئات الإنتاجية؟ نعم/لا
    
- هل تُعرض استثناءات مفصّلة للمستخدم؟ نعم/لا
    
- هل رؤوس الخادم تكشف إصدارات؟ نعم/لا
    
- هل هناك ملفات نسخ احتياطي قابلة للوصول للعامة؟ نعم/لا
    
- هل المفاتيح أو بيانات الاعتماد مخزنة في الشيفرة؟ نعم/لا
    
- هل robots.txt يكشف مسارات حسّاسة؟ نعم/لا
    
- هل السجلات مؤمّنة وتُحذف أو تُقَلَّص؟ نعم/لا
    

# 11 — أدوات مفيدة للاختبار (قانوني فقط)

- Burp Suite.
    
- ffuf / gobuster / dirsearch.
    
- curl, wget.
    
- Nikto, Nmap (لفحص الخدمة والبورتات).
    
- سطر أوامر grep للبحث في الشيفرة إن كانت متاحة محليًا: `grep -R "API_KEY" .`
        

# 13 — أمثلة رسائل خطأ آمنة (نموذج)

**غير آمن**:  
`SQL Error: Table 'customers.credit_cards' not found in /var/www/app/db.php on line 32`  
**آمن**:  
`Internal server error. Reference ID: 6f3a12. Contact support.`  
ثم خزّن التفاصيل مع Reference ID في سجل داخلي.

# خاتمة موجزة

تسريب المعلومات مشكلة شائعة لكنها قابلة للحدّ بإجراءات عملية ومنهجية. الأولوية ليست اكتشاف أي أثر فني فقط. الأولوية هي قياس الأثر العملي وإغلاق قنوات التسريب ذات التأثير الحقيقي. اتبع سياسة "الأسرار خارجة من الشيفرة" وفصل بيئات التطوير عن الإنتاج.

